{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/07/26/","result":{"data":{"site":{"siteMetadata":{"title":"SetValue.NET","author":"Raúl Fernández de Córdoba","siteUrl":"http://setvalue.net","description":"Noticias, actualizaciones y mis experiencias sobre el mundo de las soluciones cloud","social":{"twitter":"rfcm83","facebook":"","linkedin":"rfcm83","github":"rfcm83","email":"rfcm83@gmail.com","rss":"https://feeds.feedburner.com/setvalue.net"}}},"markdownRemark":{"id":"9147169e-eb08-5385-a132-ab6516cf3c63","excerpt":"Generic badge Las Logic Apps disponen de innumerables conectores que, mediante \"cuatro clicks\", te permiten realizar operaciones que en el caso de tener que…","html":"<p><a href=\"https://github.com/rfcm83/DemoManagedIdentity/\"><img src=\"https://img.shields.io/badge/rfcm83-DemoManagedIdentity-%3CCOLOR%3E.svg\" alt=\"Generic badge\"></a></p>\n<p>Las Logic Apps disponen de innumerables conectores que, mediante \"cuatro clicks\", te permiten realizar operaciones que en el caso de tener que programarlas por uno mismo, pueden suponer trabajo de días o semanas, sin embargo, esta aceleración en el desarrollo, se sustenta en operaciones que requieren la intervención manual, o la asignación de unas credenciales dentro del Portal. Sí bien es cierto, que una vez creadas las API Connection se resuelve el problema, en un entorno de producción, el usuario desarrollador no tiene por qué tener acceso a los recursos en el Portal de Azure.</p>\n<h2>Managed Identity</h2>\n<p>Para resolver este tipo de dificultades tenemos las Managed Identity, un servicio de Azure AD que consiste en un registro de aplicación que abstrae y facilita el acceso a los recursos de Azure en el que es autorizado.</p>\n<p>Nos encontramos con dos tipos de Managed Identity:</p>\n<ul>\n<li><strong>System-Assigned Managed Identity</strong>. Son directamente habilitadas por una instancia de un servicio de Azure, cuando se habilitan se crea un registro en el Azure AD y sus credenciales quedan configuradas en el recurso en el que se ha creado. Su ciclo de vida queda supeditado al ciclo de vida del recurso de Azure.</li>\n<li><strong>User-Assigned Managed Identity</strong>. Son definidas de forma independiente a cualquier servicio de Azure, al crearse se define un registro de aplicación en Azure AD y puede ser asignado a uno o más servicios de Azure. Su ciclo de vida no depende de los recursos en los que está asignada.</li>\n</ul>\n<h2>Let's go</h2>\n<p>Las Logic Apps son unos workflow que se pueden desarrollar directamente en el Portal de Azure y que, gracias a toda la funcionalidad de caja que traen los conectores, permiten desarrollar una solución en minutos u horas, sin embargo, desarrollar estos flujos desde el Portal no es una buena práctica, pues no todos los miembros de un equipo de desarrollo tienen por qué tener el mismo nivel o si quiera acceso a un grupo de recursos o una suscripción. \"Otro problema\" que hay en este sentido, es que las Logic Apps se versionan en el Portal, puedes crear la solución y cada guardado mantiene una versión que te permite volver y comparar con una versión anterior, pero esto nos aleja de un repositorio de Git dónde debería estar todas las versiones de código de la solución.</p>\n<h3>Requisitos</h3>\n<p>Microsoft provee estas dos extensiones para poder trabajar las Logic Apps desde <a href=\"https://marketplace.visualstudio.com/items?itemName=VinaySinghMSFT.AzureLogicAppsToolsForVS2019\" target=\"_blank\">Visual Studio 2019</a>, <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-logicapps\" target=\"_blank\">Visual Studio Code</a>, y versiones anteriores <a href=\"https://marketplace.visualstudio.com/items?itemName=VinaySinghMSFT.AzureLogicAppsToolsforVisualStudio-18551\" target=\"_blank\">2017</a> o <a href=\"https://marketplace.visualstudio.com/items?itemName=VinaySinghMSFT.AzureLogicAppsToolsforVisualStudio\" target=\"_blank\">2015</a>.</p>\n<p>Una vez instalada en el IDE de nuestra preferencia, la edición de las Logic Apps se puede versionar en un repositorio de código.</p>\n<h3>Recursos</h3>\n<p>Para este ejemplo, en el Portal, en un nuevo grupo de recursos, creamos:</p>\n<ul>\n<li><strong>Logic App</strong>. Es el flujo que va a realizar la conexión al Key Vault para recuperar un secreto y al Storage Account para agregar un mensaje a una cola.</li>\n<li><strong>Key Vault</strong>. Depositará el o los secretos a los que puede acceder la Managed Identity de la Logic App</li>\n<li><strong>Storage Account</strong>. Gestionará en una cola los mensajes que le envíe la Logic App.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/62fb091bcdecc1dcdaecb0acee5a3976/29114/ManagedIdentity-00.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABG0lEQVQoz51R3U6CMQzdk6r4d2d8AcUfMJIYb8VgMAZD4ktgMD6O4vcx1m3tus0OhCtJlOakW7qec5pOHbYfjzpPjWZ36+Rup3l/0Oq3BqP2YHT1/NoZjud4ux6Ob17ej29ftk+7+5f93fOHxllv76KntK6g+rB64mGagkvR5xyXSLlEWt4557DMBeqz1taCc8541J61I0TimASB4yI7CpZiTCnNNVZQ1jkpWmuNMRSoBmccApInzmtC+pk5xqg0QEoRACZ1jYGRKJSXJEaL1hBC5B8hISBiKRJJh5pZzHPnL7CcfvERMhGtyN771ZOq9FTEpMS8ds51oSpTo0dxFtV/k0Gm5SDb3oRcG81hU/IMjPxsWUrJ5fy7yjey1HE5+TczygAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Resources\"\n        title=\"Resources\"\n        src=\"/static/62fb091bcdecc1dcdaecb0acee5a3976/587b0/ManagedIdentity-00.png\"\n        srcset=\"/static/62fb091bcdecc1dcdaecb0acee5a3976/8aea6/ManagedIdentity-00.png 243w,\n/static/62fb091bcdecc1dcdaecb0acee5a3976/44c61/ManagedIdentity-00.png 485w,\n/static/62fb091bcdecc1dcdaecb0acee5a3976/587b0/ManagedIdentity-00.png 970w,\n/static/62fb091bcdecc1dcdaecb0acee5a3976/5b795/ManagedIdentity-00.png 1455w,\n/static/62fb091bcdecc1dcdaecb0acee5a3976/29114/ManagedIdentity-00.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Dentro del blade de <em>Identity</em> de la Logic App, activamos <strong>System Managed Identity</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0fa7cfe412849c107964638fb0343a41/29114/ManagedIdentity-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAA90lEQVQoz52RzUpDMRCF86CCP9y69QX894qC4Fat2kVR6EsUBfc+g0sRae9tMslkJj9OFEQshfYevoRsTs5JRm3Xd1U9WNu92ti/EXong3o4Fk6H4/PH5x/OHp4uRi87l6P1vevq+H7r8HbzoF8d9RWaiW4m5HSOLrMtZM45ffNPISfKmcpeDqxaizlFcPj69jlttTEA1nnPstDTXzzxLxxCTElpAI9ojHn/aBBQ7k8xxeWkJMw5hyJtyfrSbr7vAqmZtUwk7hBCXlFK65aZsZt52jToHBgjb1jZ3MxMIAKATrVBSyYRdUo2Wj6My+TC/DC8THuxvgAEjHBHOOLaUAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"System Managed Identity\"\n        title=\"System Managed Identity\"\n        src=\"/static/0fa7cfe412849c107964638fb0343a41/587b0/ManagedIdentity-01.png\"\n        srcset=\"/static/0fa7cfe412849c107964638fb0343a41/8aea6/ManagedIdentity-01.png 243w,\n/static/0fa7cfe412849c107964638fb0343a41/44c61/ManagedIdentity-01.png 485w,\n/static/0fa7cfe412849c107964638fb0343a41/587b0/ManagedIdentity-01.png 970w,\n/static/0fa7cfe412849c107964638fb0343a41/5b795/ManagedIdentity-01.png 1455w,\n/static/0fa7cfe412849c107964638fb0343a41/29114/ManagedIdentity-01.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Tras crear la identidad gestionada, en las <em>Access policies</em> del Key Vault, agregamos la identidad de la Logic App para que pueda ver los secretos. Y agregamos un nuevo secreto con un texto aleatorio.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/992773abb861e230942d0eba68debeff/29114/ManagedIdentity-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/0lEQVQoz6WPS0oDQRRFa51+Bn4ycwUaEJOo6AKM+AkkRHARBgVXoHsQB4np6urq7qp6P4t0dNBBTfBwqcHl3Xrvqkb7ZrvVW9vvrjcvN5rd3dZtu//QGYyOB6PTu6dKJ8PH8/vnvbPh5sFFo9PbObreOryKr3I2zTNN4ERAGERQfqCw2ttEyAmWlVRROh8AEMvShQDeg3MhetEilm8xizbZeDJOptMkSbTWJk1VblLvSkTSqYUYqeSAkGqbmeuOenkzWRFvFo8sv8JcH1DGM/2R+grTwmZZmo/MZtZCCDT7JYSwQhhjaZ5TtVghTIud5R8oWhKE1/d8kuPs4Hn4E/lsccbW6OgZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Access Policies\"\n        title=\"Access Policies\"\n        src=\"/static/992773abb861e230942d0eba68debeff/587b0/ManagedIdentity-02.png\"\n        srcset=\"/static/992773abb861e230942d0eba68debeff/8aea6/ManagedIdentity-02.png 243w,\n/static/992773abb861e230942d0eba68debeff/44c61/ManagedIdentity-02.png 485w,\n/static/992773abb861e230942d0eba68debeff/587b0/ManagedIdentity-02.png 970w,\n/static/992773abb861e230942d0eba68debeff/5b795/ManagedIdentity-02.png 1455w,\n/static/992773abb861e230942d0eba68debeff/29114/ManagedIdentity-02.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Ahora, en la Storage Account, en el blade de <em>Access control (IAM)</em> asignamos el rol de <strong>Storage Queue Data Contributor</strong>, después en <em>Queues</em>, hacemos <strong>Switch to Azure AD User Account</strong> en <em>Authentication method</em> y creamos una nueva cola llamada <em>log</em>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29ee7ee07b63ee6ad50554e52a1f7699/29114/ManagedIdentity-03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAA70lEQVQoz52RwU4CMRCG+6DGiLpnX0BRQTQx8UyWiIkEEx5CoomvI0K3026nM22dBQ9gwmH58t+m//wzHVX0novBy9HlsNMtT7pl0R/3X9/vJvPBZP7w9rnR/fTjcfZ18TQ7vhqe98anN6POdXl2O1LV4hv0D9WQqc7sc8K8l5gzb4mUdj5yRAyL5cqA9RjAkycm5kCNMNBGxPIwbUtVAIhorfV1nVJqAtIORBTWMPNuJSmwjdk5F2PMLRGzkRHFLI1bm40BsclshyQba7XWslJuj1qBDYgS+/dbLZNdZD7QvKyMJMvOvG7xDzmE388vKPdxjk/tsmQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Switch to Azure AD Account\"\n        title=\"Switch to Azure AD Account\"\n        src=\"/static/29ee7ee07b63ee6ad50554e52a1f7699/587b0/ManagedIdentity-03.png\"\n        srcset=\"/static/29ee7ee07b63ee6ad50554e52a1f7699/8aea6/ManagedIdentity-03.png 243w,\n/static/29ee7ee07b63ee6ad50554e52a1f7699/44c61/ManagedIdentity-03.png 485w,\n/static/29ee7ee07b63ee6ad50554e52a1f7699/587b0/ManagedIdentity-03.png 970w,\n/static/29ee7ee07b63ee6ad50554e52a1f7699/5b795/ManagedIdentity-03.png 1455w,\n/static/29ee7ee07b63ee6ad50554e52a1f7699/29114/ManagedIdentity-03.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Desarrollo</h3>\n<p>En Visual Studio, creamos un nuevo proyecto de tipo <em>Azure Resource Group</em>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d9ee181437dcf7088de6092585cecf23/2bef9/DemoManagedIdentity.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.2551440329218%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABX0lEQVQ4y4WT2ZaCMBBE+f9f9GVcADcSQnaCp6Y7gAM46sM9xCYpuqti0fc9jDEZa+2Kuc57UkrP5wz/nmshBCKiiDHicDhgt9vheDzidCpRVRXKssT+5yc/A+1ZCv4nPK+zoJQSSil0XZc7S7SB68Mw4PF4vD287HBeF9xqXZ9xvd5oPItIRe6I22f8NEom9i9CW4pIB0Rzh2oldKdgNHdpSMC/4G0H78Pb0aeRA6RooFWLjlCtgDUaPdX76Fd4PU7xUZBHquobLnfy0AQY10PbmNediQv4Hfn6bWT2hv3b13cScpNvEzTelk9pP1NuGoEbiQpBPmpDibNXPgcU45rvgjTy5XxGK9k7A+fsM5SePjZ6ORKpthVcM4WilaRAJLyjf0VwdJCuj7cIK0xOeXtt+K4OQ8qkRPfwrziMmyfSG5ZibAunbpyn0NzY4WvbX1iMzGJSKghlcRWaLn7CLw4m9ErIfi92AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"New Azure Resource Group\"\n        title=\"New Azure Resource Group\"\n        src=\"/static/d9ee181437dcf7088de6092585cecf23/587b0/DemoManagedIdentity.png\"\n        srcset=\"/static/d9ee181437dcf7088de6092585cecf23/8aea6/DemoManagedIdentity.png 243w,\n/static/d9ee181437dcf7088de6092585cecf23/44c61/DemoManagedIdentity.png 485w,\n/static/d9ee181437dcf7088de6092585cecf23/587b0/DemoManagedIdentity.png 970w,\n/static/d9ee181437dcf7088de6092585cecf23/2bef9/DemoManagedIdentity.png 1024w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Seleccionamos de las <em>Visual Studio Templates</em>, la plantilla de Logic Apps. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 786px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d5f1859681684a3f3c9ab607de006d0/321ea/LogicAppTemplate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.30864197530865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACT0lEQVQ4y5VUS2sTYRSdrWtR/0X34t4/4E7xTwjiyroQVNRV3bh0UTduBAuC9YHFByaWEBNqx8lrkk4y7/d7MpPj/b50bMEq6YXD5ftmOPfce8+MYOg6LMsGy0mSoMgLzOdzlGXJc1EUhKPM7v6FOI4hmIaB4XCE0XCIyWQCg85BGAHzDB0lwMWNLi4R1h61cXNrjIPRAJLUw2KxwEkhmLYDTTdgUWZKgyAkwhhlGuHdnoazt79zsvPrTVx5JqLIEkRRzDuoqooTH4dQaGNA7pAyE57rcdnVYbUPooG1x21c25Rw+ekerj+X/hD6nk/FAyI9IuMKuzMbr39NSZ1F88v5ZVktH34d2Di3vosLd3Zx5lYDVzd7qPIUIRGmafZXu1zhthLj3n4K2zRJXYJ6NHmWQbMcdA48tGUbLdlBX/OpCxe2bcPzfSJN+SIZ8kMxwo5oYuOjAscyEAU+asYsTWCTapQ5iiTiygq6S6goG0uapDxHUYSIlphlS8XCy46OG1symv0p2jMfopNDdAv8mHnQDGvZClYL3vJbycaDTyo+S1M0Ji5aWoyWHqM5cTDTTf7i8cH/D1zhm/cD3H34BbJMXpRlmKYN1/O4fVhLdeVVQ+j2dbz6NoFFS3EdZ2kF8tiCPFbP5XSEqoUXkgqPVDlkblVV+daYadkWa8JVIWzvDHH/SQOzKW2aKSQ75PQ9sy+hJjxNCIpi4Of+mGZncYKKqtQ/BpZZVaZ2VQi+79GsEoRhCJ/UsdZZrsHOJ4F1opPx93oyJFmBKIro9/v4DZIbbWAWHlspAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Logic App\"\n        title=\"Logic App\"\n        src=\"/static/8d5f1859681684a3f3c9ab607de006d0/321ea/LogicAppTemplate.png\"\n        srcset=\"/static/8d5f1859681684a3f3c9ab607de006d0/8aea6/LogicAppTemplate.png 243w,\n/static/8d5f1859681684a3f3c9ab607de006d0/44c61/LogicAppTemplate.png 485w,\n/static/8d5f1859681684a3f3c9ab607de006d0/321ea/LogicAppTemplate.png 786w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Una vez se ha terminado de cargar el nuevo proyecto, se habrán generado un fichero PowerShell junto con dos ficheros JSON, uno de ellos es la definición de la Logic App y el otro es el fichero de parámetros.</p>\n<p>En el fichero de definición de la Logic App, establecemos en \"Resources\" que vamos a utilizar System Managed Identity.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">      <span class=\"token property\">\"identity\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"SystemAssigned\"</span>\n      <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Además de poder modificar la definición de la Logic Apps desde el JSON, también podemos acceder en modo diseñador con la opción <em>Open With Logic App Designer</em>. Esta opción nos solicitará una suscripción y un grupo de recursos, seleccionamos el Resource Group que contiene la Logic App con la Managed Identity.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9c092cbe3a12544564e4c327fb76b651/89557/LogicApp-OpenWithDesigner.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSUlEQVQoz6WSz0sCQRTH958sXLVOkmZdgy7SpUP9Ae3asRI1UGv1ItIlgsDQ1dafpOaqq65KKNFkbTLfZluoQ5dyDx/mDfP4vPdmhgvFZJzEcgglCohKMs5TRZyy/VlcRkS6x0W6BClTQTSpICwpiKbKLLaIJEu4vlGQz5XpXbaAdCZLOLdfBO8V4PSJv+B9AhzszLEhfMVOhpVrrTzLSV/lUK01aE8bI5tvEm5t6xh2uJU7aKhTOpoCzd6rPaE5nVLTUW8TWm3NUVcNS+j2B5cUBlGs9KFqL7QzMNCy36Ep1KDphOpPgNqf2xcqtQEeuzPa1gi00Yc9oWtTRKmus5GfaXf4jq5umN8miP/yI7TucDgmdDJdsNeeLdfh+raFi8mb6gQLCvpmANUHnXBmFd4rfrPqEf7MiucIgYMEAoeXdHc/jp29MPkEkspIilOu99cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Logic App Open With Designer\"\n        title=\"Logic App Open With Designer\"\n        src=\"/static/9c092cbe3a12544564e4c327fb76b651/587b0/LogicApp-OpenWithDesigner.png\"\n        srcset=\"/static/9c092cbe3a12544564e4c327fb76b651/8aea6/LogicApp-OpenWithDesigner.png 243w,\n/static/9c092cbe3a12544564e4c327fb76b651/44c61/LogicApp-OpenWithDesigner.png 485w,\n/static/9c092cbe3a12544564e4c327fb76b651/587b0/LogicApp-OpenWithDesigner.png 970w,\n/static/9c092cbe3a12544564e4c327fb76b651/5b795/LogicApp-OpenWithDesigner.png 1455w,\n/static/9c092cbe3a12544564e4c327fb76b651/89557/LogicApp-OpenWithDesigner.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Una vez, seleccionado el grupo, tendremos la misma experiencia de diseño de Logic Apps que hay en el portal.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7065adf797aa910e35ac33023db8a182/89557/LogicAppDesigner.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC00lEQVQoz22S+0+TVxjH+2ct2bJkc2o0oBHn6tAxGdvUYXQaTUxcgkSBlHZa52xHRU2UmEkEb2W04Lz0okIgFJztpJSWLvT6tm9vb9u3wPvZgf4wTfYk55zveb7nfHIuj84xNoF91MuN373cGnzOzUEX/QNPuH7bJbSXh84Z7ONzDI34uDsyy+CjGQbtdT30xxzDzrfcGQloA/dn6b8zreia206w43M9pstWrtj6sV69gcV2nSt91zCLXMt3R2lua2f/t0do/uYHvmw9zO59bXzWuEfodtwv3zAxPa+9DaXwTIYUXdNXJ9i2S898JIwGROMJgtF/WI98qcShYycF7DAt37cLwEGa9rWyc28Lmxqa0B84xEJ4mVg8ram1NRYikqJr0Lfz8dYG/MFFVAGJSRliaYkVoaWszK7mVj7Z3sSWnV+wSZzqw82NfCTaB59uE+BW4qk8tVW09cPML6YV3enOy5w3GHE6nDx1uXnm9jD9ahKXx8v4k2f0mi7Scd5AR1cvJmMv3QYTnT0mMTdgNFtISkWqtXeA7pd+aisqo28WCMwHCUciWKanmAuFSCYSTEVlYpk8a2qZWz6F2aUsallAqlUymRySXKaiav8Bn7rnkAtFjtvz4rpFYap8/cCHLxITGxV+vudnyh+lopRwDF3iL98LiqUKhXyOeDz1/0BFLHb6ZGEWyOVyvAikWU5mhJYJ/B0hm5EplBRY+hMtuyQ+qw5MJNLinZX3gY+fzwpggaKcIpVMiWvIlIsSyWQCSZK4N6PgC8tUCzJ9rxdxh6KU83myssxyLEkqU9p4w/WqCIYF0PPKL+Qq9Vjb6FU1x9pqZUP/+Ai80bqrd3kYiS3XV2o1SsUi5coK5aqmVUVZBIJJRfdTz13MNieXbGOY+5xcsDq5+Nu4yD0W4xjnzKMYLeveGGd/sWOwODb0BasD46+jdJvtnOkZ1k53DXOq47byL1jMzB12Fu0vAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Logic App Designer\"\n        title=\"Logic App Designer\"\n        src=\"/static/7065adf797aa910e35ac33023db8a182/587b0/LogicAppDesigner.png\"\n        srcset=\"/static/7065adf797aa910e35ac33023db8a182/8aea6/LogicAppDesigner.png 243w,\n/static/7065adf797aa910e35ac33023db8a182/44c61/LogicAppDesigner.png 485w,\n/static/7065adf797aa910e35ac33023db8a182/587b0/LogicAppDesigner.png 970w,\n/static/7065adf797aa910e35ac33023db8a182/5b795/LogicAppDesigner.png 1455w,\n/static/7065adf797aa910e35ac33023db8a182/89557/LogicAppDesigner.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Agregamos un trigger de tipo <em>HTTP request is received</em>, que espere un método GET y con este esquema en el cuerpo.</p>\n<ul>\n<li><strong>Method</strong>: GET</li>\n<li><strong>Relative path</strong>: /secrets/{secretName}</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"secretName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d60e53637328f9670de94a1ded5bab51/29114/ManagedIdentity-04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.73251028806584%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABhklEQVQoz42Qy0vDQBDG8w8LHgRvIohoPYkotRdvPlCklapF09ZStOhB0xobtWmpz5g0j262ySbbbhKnWpCqVD+GZb+Z/c0My/E5IVsUdo6kVPYmlZc2Dyq7x9J+Qc6WGrnzZrpQ38vJ6ZP6fqGxnRET68WtzN1GpraWrMS3BS5/WiYOUjSjpRtPakt4fL17eL6UatdyU6w/SM0npWVomm5aSChXlpZX82eV0lXttqFlSzKXP5NYj2KMnb46lFJCCLJRx+mAd10XbL/QgZJPu0xptR9fVLhUZY3LnVa71EPIxh9ijEXDAt62B1VV1U3b83tREEVi7QfsgXwPhoRBX2EYEDKAYbpuWCbyCA1/h2HL/iiMCTTxfWgFC3+W/oZB8BqM1UYYfyXtf8KDFsP2G8zCSLxXOb4oEtfRdcs026PDspDypquG4/oBwNcAFy9uo4j1upCgI4IxGgVd+A7Xo5gwxw+vJIWbjKUWEnwswcM5Hx8VsTg/u3I0vXg4MZcan0mOTW2+A+dYSD7VmyDQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Trigger\"\n        title=\"Trigger\"\n        src=\"/static/d60e53637328f9670de94a1ded5bab51/587b0/ManagedIdentity-04.png\"\n        srcset=\"/static/d60e53637328f9670de94a1ded5bab51/8aea6/ManagedIdentity-04.png 243w,\n/static/d60e53637328f9670de94a1ded5bab51/44c61/ManagedIdentity-04.png 485w,\n/static/d60e53637328f9670de94a1ded5bab51/587b0/ManagedIdentity-04.png 970w,\n/static/d60e53637328f9670de94a1ded5bab51/5b795/ManagedIdentity-04.png 1455w,\n/static/d60e53637328f9670de94a1ded5bab51/29114/ManagedIdentity-04.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Seguimos agregando una <em>action</em> de tipo HTTP y le configuramos:</p>\n<ul>\n<li><strong>Method</strong>: GET</li>\n<li><strong>URI</strong>: Como expresión, agregamos <code class=\"language-text\">concat(&#39;https://demomikv.vault.azure.net/secrets/&#39;, triggerOutputs()[&#39;relativePathParameters&#39;][&#39;secretName&#39;])</code>(donde demomikv es el nombre de nuestro Key Vault)</li>\n<li>\n<p><strong>Queries</strong>: </p>\n<ul>\n<li>Key: api-version</li>\n<li>Value: 2016-10-01</li>\n</ul>\n</li>\n<li>\n<p><strong>Authentication</strong>: Agregamos el parámetro, y le definimos:</p>\n<ul>\n<li><strong>Authentication type</strong>: Managed Identity</li>\n<li><strong>Managed Identity</strong>: System Assigned Managed Identity</li>\n<li><strong>Audience</strong>: <a href=\"https://vault.azure.net\">https://vault.azure.net</a></li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/416d821d7c8a56d20803a6045cfe2ef7/89557/ManagedIdentity-05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB6klEQVQoz5WRXU8TQRSG+6dNTDTxSrkwGkwkBPSSmKCImtClDfbDdLmQBGrTQm0XbAEL3W53dz529mPW7uvplnhngIs3M9k58+xzzhQqtSNUvx3iU6kDo9LBTuUYm8UWPhptfNk7wV6jj6+mhWKtD6PaR7HSg1GzsEU1bzbq+GCc4L3RzTY+/8DbzUNVqDeaCKWP67GDqeNiMBrB7LZwejnEz/MBZQjr8hy9iyEurq5h2w5c10ez2cLrlTXUzRYOjqysdzaBeXBGwP1jpDqGEAJBoMDYFFxeIXQ5AuYh0QG0VohiAS58qgkgpUCSxEjTGcYTH79HdqbTDKfDqSrUzDYdhvB9Bs4FARl0qhHJCIEIEEURlAqpJgHjPtXwPEJwjMcTeCxCrJFlAPq/nDmwA03AOWhuyRhZKImYDGQgyU7nsDiOboAiB84tHRqRy0JESfZ/IOeM2hJQMoDnOAjpm040gRNqmf0zvBdwPitBl13Xya1kQC1Klu/FfQ0X0IUFo3i+v/gJZzezuwVYbbRp8IpsvPxhbouXx88FxvYUjqfoUXIerAEB9793aTvDnzRBNtN3DpDmIlGcIoxnGS3oWrYqPF7awvJaCcvrZVrLeLFaulNerpbxfGUXz17t4NHSdvbw6TYePHmn/gLh/SKxe81U1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Get Secret\"\n        title=\"Get Secret\"\n        src=\"/static/416d821d7c8a56d20803a6045cfe2ef7/587b0/ManagedIdentity-05.png\"\n        srcset=\"/static/416d821d7c8a56d20803a6045cfe2ef7/8aea6/ManagedIdentity-05.png 243w,\n/static/416d821d7c8a56d20803a6045cfe2ef7/44c61/ManagedIdentity-05.png 485w,\n/static/416d821d7c8a56d20803a6045cfe2ef7/587b0/ManagedIdentity-05.png 970w,\n/static/416d821d7c8a56d20803a6045cfe2ef7/5b795/ManagedIdentity-05.png 1455w,\n/static/416d821d7c8a56d20803a6045cfe2ef7/89557/ManagedIdentity-05.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Renombramos la action, y marcamos en los settings que su output esté cifrado.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f793b4403f42c71225a07a8b5734546/89557/ManagedIdentity-06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACDklEQVQoz52S22sTQRTG808LgoJP2gepVEWDl8ciqKEViWlCm0tpAk0wN5OatmnT2sYku7O37O7sZi+Zz7MTKiIi6MLHmbPz7W/PnDOpYrmF0n4T2/k+csU+ssUjZAo9fNwbYKcyROVwhP3GJXarFzLPFk+QKw+R+dTFq80K3ue+4l1uIDY/dPD6bZOnKgdteI6J6YxBYzpG4wm2KzWUq4fYI+1W6yjVGnJ9NvoGVdWg6SY6nS6ePE1TMW00WkNxcq6g2jgnYO0IUbiAbdvg3IWh62g1W/hMqtcbaLba6Ha/yDibzeB5nvSGYQDPD3A1Zvg+UUUYLXF2qfFUudpDEHgwTUsaDcOQH8VRhDiO8OvjOA7m87mU49i4Hk+hMBtBBCFo/3TEEmAfIQEtawU0TROaxsAMC4sgQBSt3HEc/4Qlcl0Hk6mKGQEX4V+ABgGZouD0SoFmmHCpKs49+L4v9/8dSBBDZzi+ZuDUI0CQW8gK/xuoaxomqg6Xc2p+KPU7MOmnQhNnBocfCLG8AZYOenQcDl035GAYwRjTYM9tAjgSmig5drJvJKKfWtZcXjVVd2WFydCGFwSs1Qe0XNJUA4glVRL5Ust4ldM4SJGMSX6j5J3ncbo6FBdCLMgyGCo8dXctg40XeWy8LFAsYD2dx6P0Kq4/z6/iH5R4Hj7bwYPHWdxZ2xK372/h1r03/Ae5Kx6HUe2LsQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Secure Outputs\"\n        title=\"Secure Outputs\"\n        src=\"/static/4f793b4403f42c71225a07a8b5734546/587b0/ManagedIdentity-06.png\"\n        srcset=\"/static/4f793b4403f42c71225a07a8b5734546/8aea6/ManagedIdentity-06.png 243w,\n/static/4f793b4403f42c71225a07a8b5734546/44c61/ManagedIdentity-06.png 485w,\n/static/4f793b4403f42c71225a07a8b5734546/587b0/ManagedIdentity-06.png 970w,\n/static/4f793b4403f42c71225a07a8b5734546/5b795/ManagedIdentity-06.png 1455w,\n/static/4f793b4403f42c71225a07a8b5734546/89557/ManagedIdentity-06.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Después, creamos otra action de tipo HTTP para realizar por ejemplo un log de las llamadas que recibe la Logic App, esto realmente se hace a modo de ejemplo, para introducir un registro con la Managed Identity en un el Storage Account.</p>\n<ul>\n<li><strong>Method</strong>: POST</li>\n<li><strong>URI</strong>: <a href=\"https://demomisa.queue.core.windows.net/log/messages?visibilitytimeout=30&#x26;timeout=30\">https://demomisa.queue.core.windows.net/log/messages?visibilitytimeout=30&#x26;timeout=30</a> (donde demomisa es el nombre de nuestro Storage Account y log es la queue que hemos creado)</li>\n<li>\n<p><strong>Headers</strong>: </p>\n<ul>\n<li>Key: x-ms-version. Value: 2019-12-12</li>\n<li>Key: x-ms-date. Value: <code class=\"language-text\">formatDateTime(utcNow(), &#39;R&#39;)</code></li>\n</ul>\n</li>\n<li>\n<p><strong>Body</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>QueueMessage</span><span class=\"token punctuation\">></span></span>  \n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MessageText</span><span class=\"token punctuation\">></span></span>@{body('Get_Secret')}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MessageText</span><span class=\"token punctuation\">></span></span>  \n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>QueueMessage</span><span class=\"token punctuation\">></span></span>  </code></pre></div>\n</li>\n<li>\n<p><strong>Authentication</strong>: Agregamos el parámetro, y le definimos:</p>\n<ul>\n<li><strong>Authentication type</strong>: Managed Identity</li>\n<li><strong>Managed Identity</strong>: System Assigned Managed Identity</li>\n<li><strong>Audience</strong>: <a href=\"https://storage.azure.net\">https://storage.azure.net</a></li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8c1a7f07d1bb2c75643b529e4ea41763/29114/ManagedIdentity-07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.73251028806584%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABy0lEQVQoz5WRTW/TQBCG/X+5cEBcQUgohFOF1EY5capAFQX6oZbYxIXQIFUCEholaR0HiSaO1/HH7nrXa6+9sZkoh3LopaP38M7sPJrRjma0e+1Of781PjZHR+bVu9ZwXx8fmtd61/78/c/h2eSgPTk6s4+/TPdOBs3dzttPV7un1uuPvxt7Pc0876ecuF4Q+NFf5F1Mp/bMseaLiYPsBbJdz/F8z/PDiPT6l1uvdvSvv7o/reEEGV1LM7sjVcg4piIRAXbHsx849kPqBsTFbBkQRBlOeMIYy3OZCHmzCOauX6hyPF1q7fNhLlNCKIsZJiFmfiJ4hANgmIjTDLB4E2BmjosCJlW1qqqB5d3Cm4aqqoQQjPEkYrGDi6LgnMMDpTEYF/nIZ2l+F0wpVUoBTBhJOOya3AOGWMNpigJXZEKpFaT3gBMhYCajcZamOXyRlHfCqqwG10gzOgNo9/0oDDGIcUEJXSKPYso5XCCNMIV6EGKMyWzuOShOshLgS4C/XYyrShV5tlISpIq1KYpMymxVrLWpwDmrMoeluJBMKJ6VvdFCe1z7UG/q9abxsmm8aNyqtqP/n4LqDeP5duvp1smj2sHDZ+8fPHnzDxqDRuzgpPiWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Add log\"\n        title=\"Add log\"\n        src=\"/static/8c1a7f07d1bb2c75643b529e4ea41763/587b0/ManagedIdentity-07.png\"\n        srcset=\"/static/8c1a7f07d1bb2c75643b529e4ea41763/8aea6/ManagedIdentity-07.png 243w,\n/static/8c1a7f07d1bb2c75643b529e4ea41763/44c61/ManagedIdentity-07.png 485w,\n/static/8c1a7f07d1bb2c75643b529e4ea41763/587b0/ManagedIdentity-07.png 970w,\n/static/8c1a7f07d1bb2c75643b529e4ea41763/5b795/ManagedIdentity-07.png 1455w,\n/static/8c1a7f07d1bb2c75643b529e4ea41763/29114/ManagedIdentity-07.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Agregamos una nueva action para devolver el secreto al peticionario que ha desencadenado la Logic App.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bea4ca28f4de942475557fec47dff35b/89557/ManagedIdentity-08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB6ElEQVQoz5WRa2sTQRSG86cFQcFPEhCleMEL+rGIl9oqNGu8JKkmChbapDZp2W6Thmazl2yT3ZnZ2SvZ17PbBqug1Q8PuzOc88w7c0q1xjbqn7awVu1CqXWxXuvhWaWDV8p3vPmwh/dNFR9bGip1lThApaZCaWhYqezg8fIGXip7eKHsZ8uvO3jyfEuWNpptBMKFaTk4caYYGia+aSoGIx3aaIRDfYzB2ECf0E0bljXBdOqi09nBnbsPKEwbm9tapvZttDb7JPzSQ5pE4JxDygCua2M4aoNxB65nYOaOwYQNl5lU48L3fQjBkSQxgjDGse5gbEyyJJ3jcHgiS43WLuI4F3kQJLVnM/RMA1MuYDMGy3Mx4Qw2MaM1JxiRS0e6CdvhiFNkGYCDgZMLu0hI6HlekdKj4iCKwSU1+gxJmiKMImpKISgdOxP6voBhTmCRMEr+IMwLc2kQBHR9v2jyfUnrU4QQ/yfMZYuGHM9jmM7cX/YWNX8VFm94lvBnEy++5//Pi38XzhfCenMXUSiLJPlg/pX8AH1swbBZMRTyQTsi4eevXczTENKnt5MCYXAxARGFpwOSYUJDzLIoBfY1W5aullew9LCKpUfviCpu3s95eyG3qO7GPQXl2+u4Ul7NLl9fxaVrT+UPmX0fu9KHkbwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Response\"\n        title=\"Response\"\n        src=\"/static/bea4ca28f4de942475557fec47dff35b/587b0/ManagedIdentity-08.png\"\n        srcset=\"/static/bea4ca28f4de942475557fec47dff35b/8aea6/ManagedIdentity-08.png 243w,\n/static/bea4ca28f4de942475557fec47dff35b/44c61/ManagedIdentity-08.png 485w,\n/static/bea4ca28f4de942475557fec47dff35b/587b0/ManagedIdentity-08.png 970w,\n/static/bea4ca28f4de942475557fec47dff35b/5b795/ManagedIdentity-08.png 1455w,\n/static/bea4ca28f4de942475557fec47dff35b/89557/ManagedIdentity-08.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Publicación</h3>\n<p>Para realizar la publicación, el primer paso es definir el nombre que tiene la Logic App, para ello, en el fichero de parámetros, modificamos el JSON de esta forma:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"$schema\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"contentVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"parameters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"logicAppName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"DemoMIla\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>En el menú contextual del proyecto de tipo <em>Azure Resource Group</em>, podemos seleccionar la opción Deploy para publicar la Logic App y desplegamos.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/54406f7b650f1fd3cbee0ad69f820b34/89557/ManagedIdentity-09.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACEUlEQVQoz42S7U/TUBTG90f7xYT4zWCMhpAQg8aPJCZkRoM4mBNwTgkKLgvdZFvZG7Try9b23tvedltnH083Fkb8gB9+uee+nOc857SZ7Q8Ktj+eI19qo3jSwc7nC7yhfXaviveFOp2rKHxvYeegSXdN7B6qyB21kM0peLVVRLFUQflMSc5+lpH/dCIzhS8VMMZgDxx4LkO3b+CH2kT7WoNKXGo62roxQzNtmOYAQ4fh9JeC9Y3XOCie47TSS6oNOzUkM8XjGqbxCJxzBIGExyx0r8vgwqa4D9fTwX0LHjfozIUMAgjhw7B9uHyKRseHejVJtCHIwFRmjr5VMR6H8DwGXwhYroua0YdDSRYVMZkHW3BYhEt7QaTFBe01rY9aw4DacZOBB2jWZC44IcG0bUGCjB6HozGEpMSAYxLHiEYjjGn1yR2/EQwCKmgNZoK9fpQMGNDVo7uC88oCYRhCymCWlI4hDOf4vn8rSLFJgheqRQ5ZolsTXBnjfx0uElIY43Bc787Z4k0qOHdo4nfTTqhdajlemuGNw9skMVuX42Vhf+Hw0ka95SS6Hc8dHpYUjCI5c5J+mP8lLdI3bCh1A42Wmww50lnKzNfjKv7EEf0ONDvpIwrvJyRGUUAuSdTk6OkiMZ2Y3Doys7KaxdrmPtZe5ol9PHuRsncvz+nd040cVtd3sfLkXfLw8Vs8eLQl/wL4sxzRDiPTmwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Deploy Logic App\"\n        title=\"Deploy Logic App\"\n        src=\"/static/54406f7b650f1fd3cbee0ad69f820b34/587b0/ManagedIdentity-09.png\"\n        srcset=\"/static/54406f7b650f1fd3cbee0ad69f820b34/8aea6/ManagedIdentity-09.png 243w,\n/static/54406f7b650f1fd3cbee0ad69f820b34/44c61/ManagedIdentity-09.png 485w,\n/static/54406f7b650f1fd3cbee0ad69f820b34/587b0/ManagedIdentity-09.png 970w,\n/static/54406f7b650f1fd3cbee0ad69f820b34/5b795/ManagedIdentity-09.png 1455w,\n/static/54406f7b650f1fd3cbee0ad69f820b34/89557/ManagedIdentity-09.png 1928w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Este proceso desencadena el PowerShell y publica los ARM que hay en el proyecto.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3e2bf14a6936d916802c945778c5fb13/29114/ManagedIdentity-10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABKklEQVQoz6WO207CQBCG+6DGU+DaFxA14CEx8RoNcIMnXqLRxDcwBiN3XGi7bLu7s4eWQtt1WoKRmhiMX/6L2Zn5suPUm916q7ex395sXG0fXGJ93Hdbfffk2j27fVzk9ObhfPC0dzHYarRrzd7uUWfnsFNrdp1ZJDWwxEibz2w6zdJpbjNbkNsq2J9bm2LyLElj5UyTxEQxRptI6SIU1JAEXsg/uCBSYXypuNLGROWaSebzt9Ho7n7gGGOEEAAgS7TSlE2G4+eATUjo+YEXCEoYYYLhCixBhTFWyF/mUqbD8UsIIeHED70A6IQTDlzJFbTWVRk3qBCvhFKQnoB3vBykD5KXo+8oparywo9wglVxZ/GsaL/JhfWj8wd5Hf4tx3Fs1gC3xSr45SdGmlhQgHY2hwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Deployed\"\n        title=\"Deployed\"\n        src=\"/static/3e2bf14a6936d916802c945778c5fb13/587b0/ManagedIdentity-10.png\"\n        srcset=\"/static/3e2bf14a6936d916802c945778c5fb13/8aea6/ManagedIdentity-10.png 243w,\n/static/3e2bf14a6936d916802c945778c5fb13/44c61/ManagedIdentity-10.png 485w,\n/static/3e2bf14a6936d916802c945778c5fb13/587b0/ManagedIdentity-10.png 970w,\n/static/3e2bf14a6936d916802c945778c5fb13/5b795/ManagedIdentity-10.png 1455w,\n/static/3e2bf14a6936d916802c945778c5fb13/29114/ManagedIdentity-10.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Pruebas</h3>\n<p>Finalmente, una vez está publicada la Logic App en el portal, en el trigger podemos obtener la url a la que debemos invocar con el método GET. En Postman podemos hacer una prueba invocando esta url y pidiéndole el secreto que habíamos creado en el Key Vault.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/996b031159194c4ba616d3b3e0f8fce0/29114/ManagedIdentity-11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.32098765432099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABKklEQVQoz41Ry07DMBD0/9+bRE0dQOI3euWOkGgJfTiOkDglpSFt/FymKQ2umgMjO9mVZ3fsHTZ/SDifcZ7FcRxNJthxdEKapjzLOOdJksQXRFHMp8ljNr3js/uMs/rzo9xuykLIUubLRb543axXQohCCCllUeAvtgEKsV3lb0/P7y/LNbPGeO+JCF91PHRKYWmtux4ITA/b45xizwuStWEgnoutNfv9ngKA7ZwbUtDClLxjQ6yUquoaARi+B3Tatj3pG+2vYR0aeRY2pmuE7FFOUOyc7kXwKO8s3fQ6FxsMyeE91hv1V4yLtE1T1btd0363x06ZTlss8mPXIY+JBMpEUG2q6utwtA7TwjF0RvTHro1hXjyj/4ENNv66fTOqEDDiZLcxsMYa/QMFom1qkOrxVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Postman\"\n        title=\"Postman\"\n        src=\"/static/996b031159194c4ba616d3b3e0f8fce0/587b0/ManagedIdentity-11.png\"\n        srcset=\"/static/996b031159194c4ba616d3b3e0f8fce0/8aea6/ManagedIdentity-11.png 243w,\n/static/996b031159194c4ba616d3b3e0f8fce0/44c61/ManagedIdentity-11.png 485w,\n/static/996b031159194c4ba616d3b3e0f8fce0/587b0/ManagedIdentity-11.png 970w,\n/static/996b031159194c4ba616d3b3e0f8fce0/5b795/ManagedIdentity-11.png 1455w,\n/static/996b031159194c4ba616d3b3e0f8fce0/29114/ManagedIdentity-11.png 1920w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Tras obtener el secreto, un nuevo mensaje está publicado en la cola del Storage, aunque es un ejemplo, pues realmente no es necesario almacenar un mensaje en la cola de un Storage cuando solicitas un secreto, es un ejemplo de cómo también se puede acceder a la Storage Account con la Managed Identity. Podríamos seguir procesando esa cola y realizando alguna acción, como por ejemplo rotar el valor de ese secreto con cada petición.</p>","frontmatter":{"title":"Managed Identities en Logic Apps","date":"2020, Jul 26","description":"Acceder a diferentes recursos de Azure mediante una System Managed Identity sin necesidad de crear API connections.","tags":["Azure","AzureAD","LogicApps","ManagedIdentity","Serverless"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.941544885177453,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3poAf//EABYQAQEBAAAAAAAAAAAAAAAAAAEAIP/aAAgBAQABBQKFz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABICH/2gAIAQEABj8CNU//xAAXEAEAAwAAAAAAAAAAAAAAAAABACAx/9oACAEBAAE/IYxwr//aAAwDAQACAAMAAAAQM8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAAMBAAAAAAAAAAAAAAABEQAgMUH/2gAIAQEAAT8QaDOzEVTKX3X/2Q==","sizes":"(max-width: 1940px) 100vw, 1940px","src":"/static/bfaf86ee85371988966109410d8f0554/6b48d/Logic-Apps.jpg","srcSet":"/static/bfaf86ee85371988966109410d8f0554/2f037/Logic-Apps.jpg 930w,\n/static/bfaf86ee85371988966109410d8f0554/23f4e/Logic-Apps.jpg 1860w,\n/static/bfaf86ee85371988966109410d8f0554/6b48d/Logic-Apps.jpg 1940w"}}}}}},"pageContext":{"slug":"/2020/07/26/","previous":{"fields":{"slug":"/2020/07/20/"},"frontmatter":{"title":"SSL gratis para un custom domain","tags":["Azure","Free","Functions","LetsEncrypt","SSL","WebApp"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.4668769716088328,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAAD/9oADAMBAAIQAxAAAAG4kvjSNgmB/8QAGBABAQEBAQAAAAAAAAAAAAAAAQIAEgP/2gAIAQEAAQUC1+iaaKnp1z3hQ//EABYRAQEBAAAAAAAAAAAAAAAAAAATAf/aAAgBAwEBPwGmKv/EABYRAQEBAAAAAAAAAAAAAAAAAAASAf/aAAgBAgEBPwGNQ//EABoQAAMAAwEAAAAAAAAAAAAAAAABESEiMXH/2gAIAQEABj8CNWl6U6ZpEz//xAAcEAEAAgEFAAAAAAAAAAAAAAABACEQETFBUYH/2gAIAQEAAT8hqcQzcENR5jBR9t4CQBP/2gAMAwEAAgADAAAAEHMv/8QAGBEAAgMAAAAAAAAAAAAAAAAAABEBIVH/2gAIAQMBAT8QdFiYf//EABcRAAMBAAAAAAAAAAAAAAAAAAABEVH/2gAIAQIBAT8Qk1C9P//EABwQAQACAgMBAAAAAAAAAAAAAAEAESGBMUFRcf/aAAgBAQABPxBR2aZej2Sb0eywBfLkaijyPkGFi7VS2GQKgOp//9k=","sizes":"(max-width: 1920px) 100vw, 1920px","src":"/static/836b0ffa603d2a11cdeacb1a534cfc74/d8255/SSL.jpg","srcSet":"/static/836b0ffa603d2a11cdeacb1a534cfc74/2f037/SSL.jpg 930w,\n/static/836b0ffa603d2a11cdeacb1a534cfc74/23f4e/SSL.jpg 1860w,\n/static/836b0ffa603d2a11cdeacb1a534cfc74/d8255/SSL.jpg 1920w"}}}}},"next":{"fields":{"slug":"/2020/08/01/"},"frontmatter":{"title":"GitHub Actions","tags":["Actions","DevOps","GitHub"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.941544885177453,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd6aIC//xAAXEAADAQAAAAAAAAAAAAAAAAAAAREg/9oACAEBAAEFAhXP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAh/9oACAEBAAY/Air/AP/EABgQAAIDAAAAAAAAAAAAAAAAAAABESAx/9oACAEBAAE/IR2xFf/aAAwDAQACAAMAAAAQ/wDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAAMBAAAAAAAAAAAAAAAAAQARQSD/2gAIAQEAAT8QgiWjcef/2Q==","sizes":"(max-width: 1940px) 100vw, 1940px","src":"/static/be67388f12b35a246f24cd889c968c98/6b48d/Actions.jpg","srcSet":"/static/be67388f12b35a246f24cd889c968c98/2f037/Actions.jpg 930w,\n/static/be67388f12b35a246f24cd889c968c98/23f4e/Actions.jpg 1860w,\n/static/be67388f12b35a246f24cd889c968c98/6b48d/Actions.jpg 1940w"}}}}}}},"staticQueryHashes":["2744294623","3114762285","550521386","764694655"]}