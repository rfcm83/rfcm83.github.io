{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2020/05/31/",
    "result": {"data":{"site":{"siteMetadata":{"title":"SetValue.NET","author":"Raúl Fernández de Córdoba","siteUrl":"https://www.setvalue.net","description":"Noticias, actualizaciones y mis experiencias sobre el mundo de las soluciones cloud","social":{"twitter":"rfcm83","facebook":"","linkedin":"rfcm83","github":"rfcm83","email":"rfcm83@gmail.com","rss":"https://feeds.feedburner.com/setvalue.net"}}},"markdownRemark":{"id":"34926cca-c692-5b2e-858c-347f36fa992a","excerpt":"En el anterior post hablábamos de las Durable Function, de los tipos que había y cómo gracias al Framework de las Durable Function se podía realizar tareas de…","html":"<p>En el anterior <a href=\"../30\">post</a> hablábamos de las Durable Function, de los tipos que había y cómo gracias al Framework de las Durable Function se podía realizar tareas de ejecución prolongada (<em>long-running</em>).</p>\n<p>En este post vamos a ver los distintos patrones que existen para así poder definir una estrategia que se adapte al escenario que estemos desarrollando.</p>\n<h2>Patrones</h2>\n<p>El principal caso de uso de las Durable Function es simplificar la complejidad, y la coordinación del estado con los distintos requerimientos, para lograr este objetivo, vemos los principales patrones:</p>\n<ul>\n<li>Function chaining</li>\n<li>Fan-out/fan-in</li>\n<li>Async HTTP APIs</li>\n<li>Monitoring</li>\n<li>Human interaction</li>\n<li>Aggregator (stateful entities)</li>\n</ul>\n<p>A continuación, pasamos a detallar la definición de cada uno.</p>\n<h3>Function chaining</h3>\n<p>Es un encadenamiento de ejecución de Functions en un orden específico. El output de una Function podría ser el input de la siguiente.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290562232\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"106.84375\" style=\"max-width: 926.46875px;\" viewBox=\"0 0 926.46875 106.84375\"><style>#mermaid-1653290562232 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290562232 .error-icon{fill:#552222;}#mermaid-1653290562232 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290562232 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290562232 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290562232 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290562232 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290562232 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290562232 .marker{fill:#666;stroke:#666;}#mermaid-1653290562232 .marker.cross{stroke:#666;}#mermaid-1653290562232 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290562232 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290562232 .cluster-label text{fill:#333;}#mermaid-1653290562232 .cluster-label span{color:#333;}#mermaid-1653290562232 .label text,#mermaid-1653290562232 span{fill:#000000;color:#000000;}#mermaid-1653290562232 .node rect,#mermaid-1653290562232 .node circle,#mermaid-1653290562232 .node ellipse,#mermaid-1653290562232 .node polygon,#mermaid-1653290562232 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290562232 .node .label{text-align:center;}#mermaid-1653290562232 .node.clickable{cursor:pointer;}#mermaid-1653290562232 .arrowheadPath{fill:#333333;}#mermaid-1653290562232 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290562232 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290562232 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290562232 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290562232 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290562232 .cluster text{fill:#333;}#mermaid-1653290562232 .cluster span{color:#333;}#mermaid-1653290562232 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290562232 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A LE-B\" id=\"L-A-B\" style=\"opacity: 1;\"><path class=\"path\" d=\"M100.046875,53.421875L104.21354166666667,53.421875C108.38020833333333,53.421875,116.71354166666667,53.421875,125.046875,53.421875C133.38020833333334,53.421875,141.71354166666666,53.421875,145.88020833333334,53.421875L150.046875,53.421875\" marker-end=\"url(#arrowhead32)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead32\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B LE-C\" id=\"L-B-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M224.890625,53.421875L229.05729166666666,53.421875C233.22395833333334,53.421875,241.55729166666666,53.421875,249.890625,53.421875C258.2239583333333,53.421875,266.5572916666667,53.421875,270.7239583333333,53.421875L274.890625,53.421875\" marker-end=\"url(#arrowhead33)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead33\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-D\" id=\"L-C-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M366.9375,53.421875L371.1041666666667,53.421875C375.2708333333333,53.421875,383.6041666666667,53.421875,391.9375,53.421875C400.2708333333333,53.421875,408.6041666666667,53.421875,412.7708333333333,53.421875L416.9375,53.421875\" marker-end=\"url(#arrowhead34)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead34\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-D LE-E\" id=\"L-D-E\" style=\"opacity: 1;\"><path class=\"path\" d=\"M491.78125,53.421875L495.9479166666667,53.421875C500.1145833333333,53.421875,508.4479166666667,53.421875,516.78125,53.421875C525.1145833333334,53.421875,533.4479166666666,53.421875,537.6145833333334,53.421875L541.78125,53.421875\" marker-end=\"url(#arrowhead35)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead35\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-E LE-F\" id=\"L-E-F\" style=\"opacity: 1;\"><path class=\"path\" d=\"M634.703125,53.421875L638.8697916666666,53.421875C643.0364583333334,53.421875,651.3697916666666,53.421875,659.703125,53.421875C668.0364583333334,53.421875,676.3697916666666,53.421875,680.5364583333334,53.421875L684.703125,53.421875\" marker-end=\"url(#arrowhead36)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead36\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-F LE-G\" id=\"L-F-G\" style=\"opacity: 1;\"><path class=\"path\" d=\"M775.546875,53.421875L779.7135416666666,53.421875C783.8802083333334,53.421875,792.2135416666666,53.421875,800.546875,53.421875C808.8802083333334,53.421875,817.2135416666666,53.421875,821.3802083333334,53.421875L825.546875,53.421875\" marker-end=\"url(#arrowhead37)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead37\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-B\" class=\"edgeLabel L-LS-A' L-LE-B\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B-C\" class=\"edgeLabel L-LS-B' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-D\" class=\"edgeLabel L-LS-C' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-D-E\" class=\"edgeLabel L-LS-D' L-LE-E\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-E-F\" class=\"edgeLabel L-LS-E' L-LE-F\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-F-G\" class=\"edgeLabel L-LS-F' L-LE-G\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A-12\" transform=\"translate(54.0234375,53.421875)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.0234375\" y=\"-19\" width=\"92.046875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.0234375,-9)\"><foreignObject width=\"72.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionA</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B-13\" transform=\"translate(187.46875,53.421875)\" style=\"opacity: 1;\"><circle x=\"-37.421875\" y=\"-19\" r=\"37.421875\" class=\"label-container\"></circle><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-27.421875,-9)\"><foreignObject width=\"54.84375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Do stuff</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C-15\" transform=\"translate(320.9140625,53.421875)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.0234375\" y=\"-19\" width=\"92.046875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.0234375,-9)\"><foreignObject width=\"72.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionB</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-17\" transform=\"translate(454.359375,53.421875)\" style=\"opacity: 1;\"><circle x=\"-37.421875\" y=\"-19\" r=\"37.421875\" class=\"label-container\"></circle><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-27.421875,-9)\"><foreignObject width=\"54.84375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Do stuff</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-E-19\" transform=\"translate(588.2421875,53.421875)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.4609375\" y=\"-19\" width=\"92.921875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.4609375,-9)\"><foreignObject width=\"72.921875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionC</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-F-21\" transform=\"translate(730.125,53.421875)\" style=\"opacity: 1;\"><circle x=\"-45.421875\" y=\"-19\" r=\"45.421875\" class=\"label-container\"></circle><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-35.421875,-9)\"><foreignObject width=\"70.84375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">More stuff</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-G-23\" transform=\"translate(872.0078125,53.421875)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.4609375\" y=\"-19\" width=\"92.921875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.4609375,-9)\"><foreignObject width=\"72.921875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionD</div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>En el ejemplo siguiente, cuatro Functions son desencadenadas de forma que la siguiente recibe por parámetro el valor resultante de la ejecución anterior.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"ChainingPatternFunction\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">OrchestrationTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationContext</span> context<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionA\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionB\"</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> c <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionC\"</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> d <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionD\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> d<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">throw</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Como vimos en el anterior <a href=\"/2020/05/30/\" target=\"_blank\">post</a>, el objeto <code class=\"language-text\">context</code> puede ser utilizado para llamar a otras Functions por nombre, pasar parámetros o devolver el resultado de la ejecución.</p>\n<h3>Fan-out/fan-in (Distribución ramificada de salida y de entrada)</h3>\n<p>En este patrón, ejecutamos múltiples Functions en paralelo y esperamos a que todas finalicen.</p>\n<p>En el siguiente gráfico de ejemplo, las Functions B, C y D son ejecutadas en paralelo y luego pasan a ejecutar la Function E, quién podría utilizar el resultado de las otras tres para realizar su procesamiento.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290561462\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"230\" style=\"max-width: 393.015625px;\" viewBox=\"0 0 393.015625 230\"><style>#mermaid-1653290561462 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290561462 .error-icon{fill:#552222;}#mermaid-1653290561462 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290561462 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290561462 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290561462 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290561462 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290561462 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290561462 .marker{fill:#666;stroke:#666;}#mermaid-1653290561462 .marker.cross{stroke:#666;}#mermaid-1653290561462 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290561462 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290561462 .cluster-label text{fill:#333;}#mermaid-1653290561462 .cluster-label span{color:#333;}#mermaid-1653290561462 .label text,#mermaid-1653290561462 span{fill:#000000;color:#000000;}#mermaid-1653290561462 .node rect,#mermaid-1653290561462 .node circle,#mermaid-1653290561462 .node ellipse,#mermaid-1653290561462 .node polygon,#mermaid-1653290561462 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290561462 .node .label{text-align:center;}#mermaid-1653290561462 .node.clickable{cursor:pointer;}#mermaid-1653290561462 .arrowheadPath{fill:#333333;}#mermaid-1653290561462 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290561462 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290561462 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290561462 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290561462 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290561462 .cluster text{fill:#333;}#mermaid-1653290561462 .cluster span{color:#333;}#mermaid-1653290561462 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290561462 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A LE-B\" id=\"L-A-B\" style=\"opacity: 1;\"><path class=\"path\" d=\"M69.35804332386364,96L78.63951526988636,84.5C87.92098721590908,73,106.48393110795455,50,120.00498638731061,38.5C133.52604166666666,27,142.00520833333334,27,146.24479166666666,27L150.484375,27\" marker-end=\"url(#arrowhead16)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead16\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A LE-C\" id=\"L-A-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M100.046875,115L104.21354166666667,115C108.38020833333333,115,116.71354166666667,115,125.046875,115C133.38020833333334,115,141.71354166666666,115,145.88020833333334,115L150.046875,115\" marker-end=\"url(#arrowhead17)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead17\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A LE-D\" id=\"L-A-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M69.35804332386364,134L78.63951526988636,145.5C87.92098721590908,157,106.48393110795455,180,119.93206972064394,191.5C133.38020833333334,203,141.71354166666666,203,145.88020833333334,203L150.046875,203\" marker-end=\"url(#arrowhead18)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead18\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B LE-E\" id=\"L-B-E\" style=\"opacity: 1;\"><path class=\"path\" d=\"M242.53125,27L246.77083333333334,27C251.01041666666666,27,259.4895833333333,27,273.01063861268943,38.5C286.53169389204544,50,305.09463778409093,73,314.3761097301137,84.5L323.6575816761364,96\" marker-end=\"url(#arrowhead19)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead19\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-E\" id=\"L-C-E\" style=\"opacity: 1;\"><path class=\"path\" d=\"M242.96875,115L247.13541666666666,115C251.30208333333334,115,259.6354166666667,115,267.96875,115C276.3020833333333,115,284.6354166666667,115,288.8020833333333,115L292.96875,115\" marker-end=\"url(#arrowhead20)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead20\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-D LE-E\" id=\"L-D-E\" style=\"opacity: 1;\"><path class=\"path\" d=\"M242.96875,203L247.13541666666666,203C251.30208333333334,203,259.6354166666667,203,273.08355527935606,191.5C286.53169389204544,180,305.09463778409093,157,314.3761097301137,145.5L323.6575816761364,134\" marker-end=\"url(#arrowhead21)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead21\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-B\" class=\"edgeLabel L-LS-A' L-LE-B\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-C\" class=\"edgeLabel L-LS-A' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-D\" class=\"edgeLabel L-LS-A' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B-E\" class=\"edgeLabel L-LS-B' L-LE-E\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-E\" class=\"edgeLabel L-LS-C' L-LE-E\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-D-E\" class=\"edgeLabel L-LS-D' L-LE-E\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A-12\" transform=\"translate(54.0234375,115)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.0234375\" y=\"-19\" width=\"92.046875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.0234375,-9)\"><foreignObject width=\"72.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionA</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B-13\" transform=\"translate(196.5078125,27)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.0234375\" y=\"-19\" width=\"92.046875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.0234375,-9)\"><foreignObject width=\"72.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionB</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C-15\" transform=\"translate(196.5078125,115)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.4609375\" y=\"-19\" width=\"92.921875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.4609375,-9)\"><foreignObject width=\"72.921875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionC</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-17\" transform=\"translate(196.5078125,203)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.4609375\" y=\"-19\" width=\"92.921875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.4609375,-9)\"><foreignObject width=\"72.921875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionD</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-E-19\" transform=\"translate(338.9921875,115)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-46.0234375\" y=\"-19\" width=\"92.046875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-36.0234375,-9)\"><foreignObject width=\"72.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">FunctionE</div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>Una primera Function recuperará el literal de la cadena de conexión que utilizarán las Functions B, C y D en paralelo para llamar a un repositorio de datos y hacer operaciones sobre filas de datos. Una vez terminen cada función reporta el número de filas que se han visto afectadas, y la FunctionE totaliza el número de filas.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"FanOutFanInPatternFunction\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">OrchestrationTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationContext</span> context<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> tasks <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">List<span class=\"token punctuation\">&lt;</span>Task<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> connectionString <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionA\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    tasks<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionB\"</span><span class=\"token punctuation\">,</span> connectionString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tasks<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionC\"</span><span class=\"token punctuation\">,</span> connectionString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tasks<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionD\"</span><span class=\"token punctuation\">,</span> connectionString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">await</span> Task<span class=\"token punctuation\">.</span><span class=\"token function\">WhenAll</span><span class=\"token punctuation\">(</span>tasks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> totalRows <span class=\"token operator\">=</span> parallelTasks<span class=\"token punctuation\">.</span><span class=\"token function\">Sum</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>Result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CallActivityAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FunctionE\"</span><span class=\"token punctuation\">,</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Async HTTP APIs</h3>\n<p>En este patrón se resuelven posibles problemas de coordinación con el estado de las operaciones <em>long-running</em>, para ello, una forma es implementar una Function que desencadene la operativa, y a continuación el cliente se redirige a otra Function que le reporta el estado de las tareas, y así puede saber cómo se encuentra la ejecución.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290562307\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"230\" style=\"max-width: 317.984375px;\" viewBox=\"-20.94921875 0 317.984375 230\"><style>#mermaid-1653290562307 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290562307 .error-icon{fill:#552222;}#mermaid-1653290562307 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290562307 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290562307 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290562307 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290562307 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290562307 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290562307 .marker{fill:#666;stroke:#666;}#mermaid-1653290562307 .marker.cross{stroke:#666;}#mermaid-1653290562307 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290562307 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290562307 .cluster-label text{fill:#333;}#mermaid-1653290562307 .cluster-label span{color:#333;}#mermaid-1653290562307 .label text,#mermaid-1653290562307 span{fill:#000000;color:#000000;}#mermaid-1653290562307 .node rect,#mermaid-1653290562307 .node circle,#mermaid-1653290562307 .node ellipse,#mermaid-1653290562307 .node polygon,#mermaid-1653290562307 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290562307 .node .label{text-align:center;}#mermaid-1653290562307 .node.clickable{cursor:pointer;}#mermaid-1653290562307 .arrowheadPath{fill:#333333;}#mermaid-1653290562307 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290562307 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290562307 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290562307 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290562307 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290562307 .cluster text{fill:#333;}#mermaid-1653290562307 .cluster span{color:#333;}#mermaid-1653290562307 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290562307 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A LE-B\" id=\"L-A-B\" style=\"opacity: 1;\"><path class=\"path\" d=\"M55.55992542613636,46L60.09095348011363,50.166666666666664C64.6219815340909,54.333333333333336,73.68403764204545,62.666666666666664,78.21506569602273,71C82.74609375,79.33333333333333,82.74609375,87.66666666666667,82.74609375,91.83333333333333L82.74609375,96\" marker-end=\"url(#arrowhead16)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead16\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A LE-C\" id=\"L-A-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M14.236949573863637,46L9.705921519886365,50.166666666666664C5.174893465909091,54.333333333333336,-3.8871626420454546,62.666666666666664,-8.418190696022727,74.16666666666667C-12.94921875,85.66666666666667,-12.94921875,100.33333333333333,-12.94921875,115C-12.94921875,129.66666666666666,-12.94921875,144.33333333333334,-3.11328125,156.1891582986366C6.72265625,168.0449832639399,26.39453125,177.08996652787982,36.23046875,181.61245815984978L46.06640625,186.13494979181974\" marker-end=\"url(#arrowhead17)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead17\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B LE-C\" id=\"L-B-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M82.74609375,134L82.74609375,138.16666666666666C82.74609375,142.33333333333334,82.74609375,150.66666666666666,82.74609375,159C82.74609375,167.33333333333334,82.74609375,175.66666666666666,82.74609375,179.83333333333334L82.74609375,184\" marker-end=\"url(#arrowhead18)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead18\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-D LE-C\" id=\"L-D-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M241.23828125,134L241.23828125,138.16666666666666C241.23828125,142.33333333333334,241.23828125,150.66666666666666,220.93619791666666,160.46952071112864C200.63411458333334,170.27237475559062,160.02994791666666,181.5447495111812,139.72786458333334,187.1809368889765L119.42578125,192.81712426677183\" marker-end=\"url(#arrowhead19)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead19\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-B\" class=\"edgeLabel L-LS-A' L-LE-B\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-C\" class=\"edgeLabel L-LS-A' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B-C\" class=\"edgeLabel L-LS-B' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-D-C\" class=\"edgeLabel L-LS-D' L-LE-C\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A-8\" transform=\"translate(34.8984375,27)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-26.8984375\" y=\"-19\" width=\"53.796875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-16.8984375,-9)\"><foreignObject width=\"33.796875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Start</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B-9\" transform=\"translate(82.74609375,115)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-60.6953125\" y=\"-19\" width=\"121.390625\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-50.6953125,-9)\"><foreignObject width=\"101.390625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Do Something</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C-11\" transform=\"translate(82.74609375,203)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-36.6796875\" y=\"-19\" width=\"73.359375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-26.6796875,-9)\"><foreignObject width=\"53.359375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Results</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-14\" transform=\"translate(241.23828125,115)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-47.796875\" y=\"-19\" width=\"95.59375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-37.796875,-9)\"><foreignObject width=\"75.59375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Get Status</div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>El Framework de las Durable Function, tras iniciar una instancia, expone un webhook para que se pueda comprobar el estado de la ejecución sin necesidad de tener que realizar un desarrollo específico de comprobación de los estados.</p>\n<h3>Monitoring</h3>\n<p>Este patrón consistiría en una supervisión periódica y flexible de un workflow, por ejemplo, realizando comprobaciones hasta que se cumple una condición. En este patrón podríamos invertir el de la API asíncrona, y en lugar de exponer un punto para que un cliente externo supervise la operación, el propio monitor consume el punto de conexión y espera a que se produzca un cambio de estado o se cumpla la condición.</p>\n<p>En este ejemplo, la Function <code class=\"language-text\">Get Status</code> en lugar de exponer un API para consultar el estado de <code class=\"language-text\">Results</code>, está verificando de forma periódica el estado de los resultados y hasta que no se dan las condiciones de salida (en este caso que se complete la ejecución), no se finaliza el proceso.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290562139\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"319.0546875\" style=\"max-width: 782.5703125px;\" viewBox=\"0 -35 782.5703125 319.0546875\"><style>#mermaid-1653290562139 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290562139 .error-icon{fill:#552222;}#mermaid-1653290562139 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290562139 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290562139 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290562139 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290562139 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290562139 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290562139 .marker{fill:#666;stroke:#666;}#mermaid-1653290562139 .marker.cross{stroke:#666;}#mermaid-1653290562139 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290562139 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290562139 .cluster-label text{fill:#333;}#mermaid-1653290562139 .cluster-label span{color:#333;}#mermaid-1653290562139 .label text,#mermaid-1653290562139 span{fill:#000000;color:#000000;}#mermaid-1653290562139 .node rect,#mermaid-1653290562139 .node circle,#mermaid-1653290562139 .node ellipse,#mermaid-1653290562139 .node polygon,#mermaid-1653290562139 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290562139 .node .label{text-align:center;}#mermaid-1653290562139 .node.clickable{cursor:pointer;}#mermaid-1653290562139 .arrowheadPath{fill:#333333;}#mermaid-1653290562139 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290562139 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290562139 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290562139 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290562139 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290562139 .cluster text{fill:#333;}#mermaid-1653290562139 .cluster span{color:#333;}#mermaid-1653290562139 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290562139 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A LE-B\" id=\"L-A-B\" style=\"opacity: 1;\"><path class=\"path\" d=\"M43.49061912324069,99.763671875L50.7083284360339,115.72428385416667C57.92603774882713,131.68489583333334,72.36145637441356,163.60611979166666,83.74583235387344,179.56673177083334C95.13020833333333,195.52734375,103.46354166666667,195.52734375,107.63020833333333,195.52734375L111.796875,195.52734375\" marker-end=\"url(#arrowhead41)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead41\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A LE-C\" id=\"L-A-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M48.83313430660208,61.763671875L55.160424422168404,53.136393229166664C61.487714537734725,44.509114583333336,74.14229476886736,27.254557291666668,94.752136967767,18.627278645833332C115.36197916666667,10,143.92708333333334,10,172.4921875,10C201.05729166666666,10,229.62239583333334,10,252.9528117915753,33.254557291666664C276.2832277498173,56.509114583333336,294.3789554996345,103.01822916666667,303.42681937454313,126.27278645833333L312.47468324945174,149.52734375\" marker-end=\"url(#arrowhead42)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead42\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B LE-C\" id=\"L-B-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M233.1875,195.52734375L237.35416666666666,195.52734375C241.52083333333334,195.52734375,249.85416666666666,195.52734375,258.1875,193.7034045479734C266.5208333333333,191.87946534594678,274.8541666666667,188.2315869418936,279.0208333333333,186.407647739867L283.1875,184.5837085378404\" marker-end=\"url(#arrowhead43)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead43\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A LE-D\" id=\"L-A-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M44.04874107951971,61.763671875L51.17343006626643,46.9697265625C58.298119053013146,32.17578125,72.54749702650658,2.587890625,93.95473809658661,-12.2060546875C115.36197916666667,-27,143.92708333333334,-27,172.4921875,-27C201.05729166666666,-27,229.62239583333334,-27,254.18489583333334,-27C278.7473958333333,-27,299.3072916666667,-27,326.3151041666667,-27C353.3229166666667,-27,386.7786458333333,-27,426.208984375,-27C465.6393229166667,-27,511.0442708333333,-27,550.0013020833334,-27C588.9583333333334,-27,621.4674479166666,-27,648.6758345897638,2.4212239583333335C675.8842212628609,31.842447916666668,697.7918800257218,90.68489583333333,708.745709407152,120.10611979166667L719.6995387885826,149.52734375\" marker-end=\"url(#arrowhead44)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead44\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-D LE-C\" id=\"L-D-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M713.9102849588586,187.52734375L703.9213312157154,202.28190104166666C693.9323774725723,217.03645833333334,673.9544699862862,246.54557291666666,647.7109589514764,261.3001302083333C621.4674479166666,276.0546875,588.9583333333334,276.0546875,550.0013020833334,276.0546875C511.0442708333333,276.0546875,465.6393229166667,276.0546875,429.1647853461677,261.3001302083333C392.69024777566875,246.54557291666666,365.14612055133745,217.03645833333334,351.37405693917185,202.28190104166666L337.6019933270062,187.52734375\" marker-end=\"url(#arrowhead45)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead45\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-F\" id=\"L-C-F\" style=\"opacity: 1;\"><path class=\"path\" d=\"M353.7607550356684,149.52734375L364.8396916963904,143.31673177083334C375.91862835711225,137.10611979166666,398.0765016785561,124.68489583333333,423.3867837087664,124.40146713051165C448.69706573897673,124.11803842768995,477.1597564779534,135.97240498037988,491.3911018474418,141.89958825672485L505.62244721693014,147.82677153306983\" marker-end=\"url(#arrowhead46)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead46\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-F LE-D\" id=\"L-F-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M629.4765625,169.02734375L633.5598958333334,168.94401041666666C637.6432291666666,168.86067708333334,645.8098958333334,168.69401041666666,654.0598958333334,168.61067708333334C662.3098958333334,168.52734375,670.6432291666666,168.52734375,674.8098958333334,168.52734375L678.9765625,168.52734375\" marker-end=\"url(#arrowhead47)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead47\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-F LE-C\" id=\"L-F-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M500.65001447805946,185.25548322805943L487.24740789838285,189.0114052942162C473.8448013187063,192.76732736037297,447.0395881593531,200.2791714926865,423.02239824634324,199.88266558441342C399.0052083333333,199.48615967614035,377.7760416666667,191.1813037272807,367.1614583333333,187.0288757528509L356.546875,182.87644777842104\" marker-end=\"url(#arrowhead48)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead48\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-G\" id=\"L-C-G\" style=\"opacity: 1;\"><path class=\"path\" d=\"M333.3414498720019,149.52734375L347.82360406000157,129.10611979166666C362.30575824800127,108.68489583333333,391.27006662400066,67.84244791666667,424.4156322703337,47.421223958333336C457.5611979166667,27,494.8880208333333,27,513.5514322916666,27L532.21484375,27\" marker-end=\"url(#arrowhead49)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead49\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-B\" class=\"edgeLabel L-LS-A' L-LE-B\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-C\" class=\"edgeLabel L-LS-A' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B-C\" class=\"edgeLabel L-LS-B' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-D\" class=\"edgeLabel L-LS-A' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-D-C\" class=\"edgeLabel L-LS-D' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-F\" class=\"edgeLabel L-LS-C' L-LE-F\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-F-D\" class=\"edgeLabel L-LS-F' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(420.234375,207.791015625)\" style=\"opacity: 1;\"><g transform=\"translate(-38.6875,-9)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"77.375\" height=\"18\"></rect><foreignObject width=\"77.375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-F-C\" class=\"edgeLabel L-LS-F' L-LE-C\">Completed</span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(420.234375,27)\" style=\"opacity: 1;\"><g transform=\"translate(-38.6875,-9)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"77.375\" height=\"18\"></rect><foreignObject width=\"77.375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-G\" class=\"edgeLabel L-LS-C' L-LE-G\">Completed</span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A-18\" transform=\"translate(34.8984375,80.763671875)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-26.8984375\" y=\"-19\" width=\"53.796875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-16.8984375,-9)\"><foreignObject width=\"33.796875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Start</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B-19\" transform=\"translate(172.4921875,195.52734375)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-60.6953125\" y=\"-19\" width=\"121.390625\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-50.6953125,-9)\"><foreignObject width=\"101.390625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Do Something</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C-21\" transform=\"translate(319.8671875,168.52734375)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-36.6796875\" y=\"-19\" width=\"73.359375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-26.6796875,-9)\"><foreignObject width=\"53.359375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Results</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-25\" transform=\"translate(726.7734375,168.52734375)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-47.796875\" y=\"-19\" width=\"95.59375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-37.796875,-9)\"><foreignObject width=\"75.59375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Get Status</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-F-29\" transform=\"translate(556.44921875,168.52734375)\" style=\"opacity: 1;\"><polygon points=\"72.52734375,0 145.0546875,-72.52734375 72.52734375,-145.0546875 0,-72.52734375\" transform=\"translate(-72.52734375,72.52734375)\" class=\"label-container\"></polygon><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-51.5859375,-9)\"><foreignObject width=\"103.171875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Is Completed?</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-G-35\" transform=\"translate(556.44921875,27)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-24.234375\" y=\"-19\" width=\"48.46875\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-14.234375,-9)\"><foreignObject width=\"28.46875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">End</div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>En este ejemplo, el <code class=\"language-text\">while</code> está ejecutándose mientras no se complete el trabajo de otra Function o la fecha y hora actual sea mayor que la fecha de expiración. Cada 5 segundos hará una nueva iteración para comprobar el estado.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"MonitorJobStatus\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">OrchestrationTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationContext</span> context<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> id <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetInput</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> intervalSeconds <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> maxDateTime <span class=\"token operator\">=</span> DateTime<span class=\"token punctuation\">.</span>UtcNow<span class=\"token punctuation\">.</span><span class=\"token function\">AddHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>CurrentUtcDateTime <span class=\"token operator\">&lt;</span> maxDateTime<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">CallActivityAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GetStatus\"</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">==</span> <span class=\"token string\">\"Completed\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CallActivityAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"End\"</span><span class=\"token punctuation\">,</span> machineId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> nextCheck <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span>CurrentUtcDateTime<span class=\"token punctuation\">.</span><span class=\"token function\">AddSeconds</span><span class=\"token punctuation\">(</span>intervalSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CreateTimer</span><span class=\"token punctuation\">(</span>nextCheck<span class=\"token punctuation\">,</span> CancellationToken<span class=\"token punctuation\">.</span>None<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Human interaction</h3>\n<p>En determinados casos, un workflow requiere de la intervención humana para proseguir con su ejecución. Esta acción manual, en un proceso automatizado ralentiza significativamente la ejecución, pues las personas no tienen la disponibilidad que tienen las máquinas. Para poder realizar escenarios de este tipo se deben implementar tiempos de expiración y lógicas de compensación.</p>\n<p>En este ejemplo se inicia la ejecución y se solicita a un humano la aprobación, si el usuario no responde a tiempo se escala, pero si contesta se continúa con el proceso gestionando la respuesta que haya facilitado para la Aprobación o Rechazo.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290562207\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"185.875\" style=\"max-width: 879.2239990234375px;\" viewBox=\"0 0 879.2239990234375 185.875\"><style>#mermaid-1653290562207 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290562207 .error-icon{fill:#552222;}#mermaid-1653290562207 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290562207 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290562207 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290562207 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290562207 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290562207 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290562207 .marker{fill:#666;stroke:#666;}#mermaid-1653290562207 .marker.cross{stroke:#666;}#mermaid-1653290562207 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290562207 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290562207 .cluster-label text{fill:#333;}#mermaid-1653290562207 .cluster-label span{color:#333;}#mermaid-1653290562207 .label text,#mermaid-1653290562207 span{fill:#000000;color:#000000;}#mermaid-1653290562207 .node rect,#mermaid-1653290562207 .node circle,#mermaid-1653290562207 .node ellipse,#mermaid-1653290562207 .node polygon,#mermaid-1653290562207 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290562207 .node .label{text-align:center;}#mermaid-1653290562207 .node.clickable{cursor:pointer;}#mermaid-1653290562207 .arrowheadPath{fill:#333333;}#mermaid-1653290562207 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290562207 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290562207 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290562207 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290562207 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290562207 .cluster text{fill:#333;}#mermaid-1653290562207 .cluster span{color:#333;}#mermaid-1653290562207 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290562207 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A LE-B\" id=\"L-A-B\" style=\"opacity: 1;\"><path class=\"path\" d=\"M152.515625,92.9375L156.68229166666666,92.9375C160.84895833333334,92.9375,169.18229166666666,92.9375,179.18229166666666,93.02083333333333C189.18229166666666,93.10416666666667,200.84895833333334,93.27083333333333,206.68229166666666,93.35416666666667L212.515625,93.4375\" marker-end=\"url(#arrowhead19)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead19\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B LE-C\" id=\"L-B-C\" style=\"opacity: 1;\"><path class=\"path\" d=\"M389.14583333333337,93.4375L394.8125016954211,93.35416666666667C400.4791700575087,93.27083333333333,411.8125067816841,93.10416666666667,421.7291751437717,93.10416666666667C431.6458435058594,93.10416666666667,440.1458435058594,93.27083333333333,444.3958435058594,93.35416666666667L448.6458435058594,93.4375\" marker-end=\"url(#arrowhead20)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead20\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-D\" id=\"L-C-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M597.8801807512857,72.7968372454263L609.924457877048,68.82028103785525C621.9687350028103,64.8437248302842,646.0572892543348,56.8906124151421,666.7890663800971,52.91405620757106C687.5208435058594,48.9375,704.8958435058594,48.9375,713.5833435058594,48.9375L722.2708435058594,48.9375\" marker-end=\"url(#arrowhead21)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead21\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C LE-E\" id=\"L-C-E\" style=\"opacity: 1;\"><path class=\"path\" d=\"M597.8801807512857,114.0781627545737L609.924457877048,117.88805229547808C621.9687350028103,121.69794183638247,646.0572892543348,129.3177209181912,672.4205767967637,133.12761045909562C698.7838643391927,136.9375,727.421885172526,136.9375,741.7408955891927,136.9375L756.0599060058594,136.9375\" marker-end=\"url(#arrowhead22)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead22\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A-B\" class=\"edgeLabel L-LS-A' L-LE-B\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B-C\" class=\"edgeLabel L-LS-B' L-LE-C\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-D\" class=\"edgeLabel L-LS-C' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(670.1458435058594,136.9375)\" style=\"opacity: 1;\"><g transform=\"translate(-27.125,-9)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"54.25\" height=\"18\"></rect><foreignObject width=\"54.25\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C-E\" class=\"edgeLabel L-LS-C' L-LE-E\">Expired</span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A-8\" transform=\"translate(80.2578125,92.9375)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-72.2578125\" y=\"-19\" width=\"144.515625\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-62.2578125,-9)\"><foreignObject width=\"124.515625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">ApprovalFunction</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B-9\" transform=\"translate(300.3307342529297,92.9375)\" style=\"opacity: 1;\"><polygon points=\"6.333333333333333,0 163.96354166666666,0 182.96354166666666,-38 -12.666666666666666,-38\" transform=\"translate(-85.1484375,19)\" class=\"label-container\"></polygon><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-75.1484375,-9)\"><foreignObject width=\"150.296875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Ask Human Approval</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C-11\" transform=\"translate(533.0833435058594,92.9375)\" style=\"opacity: 1;\"><polygon points=\"84.9375,0 169.875,-84.9375 84.9375,-169.875 0,-84.9375\" transform=\"translate(-84.9375,84.9375)\" class=\"label-container\"></polygon><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-65.375,-9)\"><foreignObject width=\"130.75\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Expired Approval?</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-13\" transform=\"translate(796.7474060058594,48.9375)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-74.4765625\" y=\"-19\" width=\"148.953125\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-64.4765625,-9)\"><foreignObject width=\"128.953125\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">ProccessApproval</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-E-15\" transform=\"translate(796.7474060058594,136.9375)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-40.6875\" y=\"-19\" width=\"81.375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-30.6875,-9)\"><foreignObject width=\"61.375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Escalate</div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>En este <em>snippet</em> si la Function no recibe el resultado de la aprobación o rechazo del usuario en 72 horas, se continúa la ejecución llamando a otra Function para que gestione la falta de respuesta. Por otro lado, <code class=\"language-text\">RaiseEventToOrchestration</code> envía un aprobado a la orquestación para responder a la solicitud de aprobación.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"ApprovalFunction\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">OrchestrationTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationContext</span> context<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CallActivityAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RequestApproval\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> timeoutCts <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">CancellationTokenSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> dueTime <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span>CurrentUtcDateTime<span class=\"token punctuation\">.</span><span class=\"token function\">AddHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">72</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> durableTimeout <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CreateTimer</span><span class=\"token punctuation\">(</span>dueTime<span class=\"token punctuation\">,</span> timeoutCts<span class=\"token punctuation\">.</span>Token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> approvalEvent <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">WaitForExternalEvent</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">bool</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ApprovalEvent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>approvalEvent <span class=\"token operator\">==</span> <span class=\"token keyword\">await</span> Task<span class=\"token punctuation\">.</span><span class=\"token function\">WhenAny</span><span class=\"token punctuation\">(</span>approvalEvent<span class=\"token punctuation\">,</span> durableTimeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            timeoutCts<span class=\"token punctuation\">.</span><span class=\"token function\">Cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CallActivityAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ProcessApproval\"</span><span class=\"token punctuation\">,</span> approvalEvent<span class=\"token punctuation\">.</span>Result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">await</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">CallActivityAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Escalate\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"RaiseEventToOrchestration\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">HttpTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> instanceId<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">DurableClient</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationClient</span> client<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> isApproved <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">RaiseEventAsync</span><span class=\"token punctuation\">(</span>instanceId<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ApprovalEvent\"</span><span class=\"token punctuation\">,</span> isApproved<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Aggregator (stateful entities)</h3>\n<p>Este patrón trata de agregar datos o lotes de datos de distintos eventos e incluso orígenes, durante un período determinado de tiempo en una Entidad expuesta por una <strong>Durable Entity</strong>. El proceso podría ir realizando operaciones sobre los datos que recibe durante la ejecución del proceso y también es posible que durante la ejecución, clientes externos puedan consultar los datos agregados.</p>\n<p>Implementar este patrón con funciones normales es casi imposible, ya que es necesiario gestionar el estado o la simultaneidad. Para simplificar y poder llevar a cabo este patrón de una forma sencilla en una única Function se utilizan las <strong>Durable Entities</strong>.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1653290561891\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"176\" style=\"max-width: 307.375px;\" viewBox=\"0 0 307.375 176\"><style>#mermaid-1653290561891 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-1653290561891 .error-icon{fill:#552222;}#mermaid-1653290561891 .error-text{fill:#552222;stroke:#552222;}#mermaid-1653290561891 .edge-thickness-normal{stroke-width:2px;}#mermaid-1653290561891 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1653290561891 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1653290561891 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1653290561891 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1653290561891 .marker{fill:#666;stroke:#666;}#mermaid-1653290561891 .marker.cross{stroke:#666;}#mermaid-1653290561891 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1653290561891 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#000000;}#mermaid-1653290561891 .cluster-label text{fill:#333;}#mermaid-1653290561891 .cluster-label span{color:#333;}#mermaid-1653290561891 .label text,#mermaid-1653290561891 span{fill:#000000;color:#000000;}#mermaid-1653290561891 .node rect,#mermaid-1653290561891 .node circle,#mermaid-1653290561891 .node ellipse,#mermaid-1653290561891 .node polygon,#mermaid-1653290561891 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1653290561891 .node .label{text-align:center;}#mermaid-1653290561891 .node.clickable{cursor:pointer;}#mermaid-1653290561891 .arrowheadPath{fill:#333333;}#mermaid-1653290561891 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1653290561891 .flowchart-link{stroke:#666;fill:none;}#mermaid-1653290561891 .edgeLabel{background-color:white;text-align:center;}#mermaid-1653290561891 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1653290561891 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1653290561891 .cluster text{fill:#333;}#mermaid-1653290561891 .cluster span{color:#333;}#mermaid-1653290561891 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1653290561891 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}</style><g><g class=\"output\"><g class=\"clusters\"></g><g class=\"edgePaths\"><g class=\"edgePath LS-A1 LE-B1\" id=\"L-A1-B1\" style=\"opacity: 1;\"><path class=\"path\" d=\"M28,18L32.166666666666664,18C36.333333333333336,18,44.666666666666664,18,53,18C61.333333333333336,18,69.66666666666667,18,73.83333333333333,18L78,18\" marker-end=\"url(#arrowhead23)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead23\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B1 LE-C1\" id=\"L-B1-C1\" style=\"opacity: 1;\"><path class=\"path\" d=\"M98,18L102.16666666666667,18C106.33333333333333,18,114.66666666666667,18,123,18C131.33333333333334,18,139.66666666666666,18,143.83333333333334,18L148,18\" marker-end=\"url(#arrowhead24)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead24\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C1 LE-D\" id=\"L-C1-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M168,18L172.16666666666666,18C176.33333333333334,18,184.66666666666666,18,196.80967261904763,26.5C208.95267857142858,35,224.90535714285716,52,232.88169642857144,60.5L240.8580357142857,69\" marker-end=\"url(#arrowhead25)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead25\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A2 LE-B2\" id=\"L-A2-B2\" style=\"opacity: 1;\"><path class=\"path\" d=\"M28,88L32.166666666666664,88C36.333333333333336,88,44.666666666666664,88,53,88C61.333333333333336,88,69.66666666666667,88,73.83333333333333,88L78,88\" marker-end=\"url(#arrowhead26)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead26\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B2 LE-C2\" id=\"L-B2-C2\" style=\"opacity: 1;\"><path class=\"path\" d=\"M98,88L102.16666666666667,88C106.33333333333333,88,114.66666666666667,88,123,88C131.33333333333334,88,139.66666666666666,88,143.83333333333334,88L148,88\" marker-end=\"url(#arrowhead27)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead27\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C2 LE-D\" id=\"L-C2-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M168,88L172.16666666666666,88C176.33333333333334,88,184.66666666666666,88,193,88C201.33333333333334,88,209.66666666666666,88,213.83333333333334,88L218,88\" marker-end=\"url(#arrowhead28)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead28\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-A3 LE-B3\" id=\"L-A3-B3\" style=\"opacity: 1;\"><path class=\"path\" d=\"M28,158L32.166666666666664,158C36.333333333333336,158,44.666666666666664,158,53,158C61.333333333333336,158,69.66666666666667,158,73.83333333333333,158L78,158\" marker-end=\"url(#arrowhead29)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead29\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-B3 LE-C3\" id=\"L-B3-C3\" style=\"opacity: 1;\"><path class=\"path\" d=\"M98,158L102.16666666666667,158C106.33333333333333,158,114.66666666666667,158,123,158C131.33333333333334,158,139.66666666666666,158,143.83333333333334,158L148,158\" marker-end=\"url(#arrowhead30)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead30\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g><g class=\"edgePath LS-C3 LE-D\" id=\"L-C3-D\" style=\"opacity: 1;\"><path class=\"path\" d=\"M168,158L172.16666666666666,158C176.33333333333334,158,184.66666666666666,158,196.80967261904763,149.5C208.95267857142858,141,224.90535714285716,124,232.88169642857144,115.5L240.8580357142857,107\" marker-end=\"url(#arrowhead31)\" style=\"fill:none\"></path><defs><marker id=\"arrowhead31\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"6\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowheadPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker></defs></g></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A1-B1\" class=\"edgeLabel L-LS-A1' L-LE-B1\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B1-C1\" class=\"edgeLabel L-LS-B1' L-LE-C1\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C1-D\" class=\"edgeLabel L-LS-C1' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A2-B2\" class=\"edgeLabel L-LS-A2' L-LE-B2\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B2-C2\" class=\"edgeLabel L-LS-B2' L-LE-C2\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C2-D\" class=\"edgeLabel L-LS-C2' L-LE-D\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-A3-B3\" class=\"edgeLabel L-LS-A3' L-LE-B3\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-B3-C3\" class=\"edgeLabel L-LS-B3' L-LE-C3\"></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"\" style=\"opacity: 1;\"><g transform=\"translate(0,0)\" class=\"label\"><rect rx=\"0\" ry=\"0\" width=\"0\" height=\"0\"></rect><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span id=\"L-L-C3-D\" class=\"edgeLabel L-LS-C3' L-LE-D\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-A1-18\" transform=\"translate(18,18)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B1-19\" transform=\"translate(88,18)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C1-21\" transform=\"translate(158,18)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-D-23\" transform=\"translate(258.6875,88)\" style=\"opacity: 1;\"><rect rx=\"5\" ry=\"5\" x=\"-40.6875\" y=\"-19\" width=\"81.375\" height=\"38\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(-30.6875,-9)\"><foreignObject width=\"61.375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\">Function</div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-A2-24\" transform=\"translate(18,88)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B2-25\" transform=\"translate(88,88)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C2-27\" transform=\"translate(158,88)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-A3-30\" transform=\"translate(18,158)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-B3-31\" transform=\"translate(88,158)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g><g class=\"node default\" id=\"flowchart-C3-33\" transform=\"translate(158,158)\" style=\"opacity: 1;\"><rect rx=\"0\" ry=\"0\" x=\"-10\" y=\"-10\" width=\"20\" height=\"20\" class=\"label-container\"></rect><g class=\"label\" transform=\"translate(0,0)\"><g transform=\"translate(0,0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"></div></foreignObject></g></g></g></g></g></g></svg></div>\n<p>Cada vez que un <code class=\"language-text\">EventHub</code> desencadene el trigger se creará una entidad y se agregará un delta con los datos recibidos.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"EventHubTriggerFunction\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">EventHubTrigger</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"device-sensor-events\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">EventData</span> eventData<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">DurableClient</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableOrchestrationClient</span> entityClient<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> metricType <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">)</span>eventData<span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">[</span><span class=\"token string\">\"metric\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> delta <span class=\"token operator\">=</span> BitConverter<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>eventData<span class=\"token punctuation\">.</span>Body<span class=\"token punctuation\">,</span> eventData<span class=\"token punctuation\">.</span>Body<span class=\"token punctuation\">.</span>Offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> entityId <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">EntityId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Counter\"</span><span class=\"token punctuation\">,</span> metricType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> entityClient<span class=\"token punctuation\">.</span><span class=\"token function\">SignalEntityAsync</span><span class=\"token punctuation\">(</span>entityId<span class=\"token punctuation\">,</span> <span class=\"token string\">\"add\"</span><span class=\"token punctuation\">,</span> delta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CounterFunction</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"Counter\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">EntityTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableEntityContext</span> ctx<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>OperationName<span class=\"token punctuation\">.</span><span class=\"token function\">ToLowerInvariant</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">\"add\"</span><span class=\"token punctuation\">:</span>\n                ctx<span class=\"token punctuation\">.</span><span class=\"token function\">SetState</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetState</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ctx<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetInput</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">\"reset\"</span><span class=\"token punctuation\">:</span>\n                ctx<span class=\"token punctuation\">.</span><span class=\"token function\">SetState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">:</span>\n                ctx<span class=\"token punctuation\">.</span><span class=\"token function\">Return</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetState</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">JsonObject</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span>MemberSerialization<span class=\"token punctuation\">.</span>OptIn<span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">JsonProperty</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> CurrentValue <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> amount<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentValue <span class=\"token operator\">+=</span> amount<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentValue <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentValue<span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">FunctionName</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">nameof</span><span class=\"token punctuation\">(</span>Counter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">Task</span> <span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">EntityTrigger</span></span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">IDurableEntityContext</span> ctx<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ctx<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">DispatchAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>Counter<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"Durable Functions Patterns","date":"2020, May 31","description":"Patrones de Durable Functions.","tags":["Azure","Functions","Patterns","Serverless"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.94,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6bQwD/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREg/9oACAEBAAEFAhXP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEgIf/aAAgBAQAGPwI1T//EABoQAAICAwAAAAAAAAAAAAAAAAEQADERQYH/2gAIAQEAAT8hNTJo6xS//9oADAMBAAIAAwAAABDQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAEFAAMAAAAAAAAAAAAAAAEAEBExQSFhwf/aAAgBAQABPxAyOF52jrByJeMVU3//2Q==","sizes":"(max-width: 1940px) 100vw, 1940px","src":"/static/27ed97e1c169ceb10426eb50dbf6bc6b/73822/Patterns.jpg","srcSet":"/static/27ed97e1c169ceb10426eb50dbf6bc6b/fe61d/Patterns.jpg 485w,\n/static/27ed97e1c169ceb10426eb50dbf6bc6b/9f4a9/Patterns.jpg 970w,\n/static/27ed97e1c169ceb10426eb50dbf6bc6b/73822/Patterns.jpg 1940w"}}}}}},"pageContext":{"slug":"/2020/05/31/","previous":{"fields":{"slug":"/2020/05/30/"},"frontmatter":{"title":"Durable Functions","tags":["Azure","Functions","Serverless"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.941544885177453,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdxSAr//xAAWEAEBAQAAAAAAAAAAAAAAAAAhESD/2gAIAQEAAQUCa5//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CIv8A/8QAHBAAAQMFAAAAAAAAAAAAAAAAAQARISAxQVGR/9oACAEBAAE/ITgEJ9XULTFH/9oADAMBAAIAAwAAABA4z//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EAn/xAAcEAACAgIDAAAAAAAAAAAAAAABEQBRICFBofD/2gAIAQEAAT8QNSCHc1c3tQiWBqbw/9k=","sizes":"(max-width: 1940px) 100vw, 1940px","src":"/static/f8e5e063265e9bce9de8ad1b54603359/6b48d/Functions.jpg","srcSet":"/static/f8e5e063265e9bce9de8ad1b54603359/2f037/Functions.jpg 930w,\n/static/f8e5e063265e9bce9de8ad1b54603359/23f4e/Functions.jpg 1860w,\n/static/f8e5e063265e9bce9de8ad1b54603359/6b48d/Functions.jpg 1940w"}}}}},"next":{"fields":{"slug":"/2020/06/07/"},"frontmatter":{"title":"Azure Static Web App","tags":["Actions","Azure","DevOps","GitHub","Preview"],"img":{"childImageSharp":{"fluid":{"aspectRatio":1.941544885177453,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwAB/9oADAMBAAIQAxAAAAECNHqZp9l//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAIBAxESMTL/2gAIAQEAAQUCStmMNBo8FflOn//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AUf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwGq/8QAGxAAAQQDAAAAAAAAAAAAAAAAEAABAjESIVH/2gAIAQEABj8C1XVi9GI//8QAGxABAAICAwAAAAAAAAAAAAAAAQARMUEhUXH/2gAIAQEAAT8hVKV2YlsddIFrEbUviAbS8zb7P//aAAwDAQACAAMAAAAQTP8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/EEyP/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/EBa//8QAGhABAQADAQEAAAAAAAAAAAAAAREAITFBwf/aAAgBAQABPxBERLo8Yj+OTjkgnuV+YICAELruKhI0UuVUWtdz/9k=","sizes":"(max-width: 1940px) 100vw, 1940px","src":"/static/35529ea937e31194a994788d4be40b93/6b48d/Cloud.jpg","srcSet":"/static/35529ea937e31194a994788d4be40b93/2f037/Cloud.jpg 930w,\n/static/35529ea937e31194a994788d4be40b93/23f4e/Cloud.jpg 1860w,\n/static/35529ea937e31194a994788d4be40b93/6b48d/Cloud.jpg 1940w"}}}}}}},
    "staticQueryHashes": ["2744294623","3114762285","550521386","764694655"]}